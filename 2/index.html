<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <title>Project 1</title>
        <style>
            body {
                max-width: 800px;
                margin: 0 auto;
                padding: 20px;
                box-sizing: border-box;
            }
    
            img {
                max-width: 100%;
                height: auto; 
                display: block;
                margin: 5px auto;
            }
    
            .image-container {
                display: flex;
                flex-wrap: wrap;
                justify-content: space-between;
            }
    
            .image-container img {
                flex: 1 1 calc(25% - 10px);
                margin: 5px;
            }
    
            @media (max-width: 800px) {
                .image-container img {
                    flex: 1 1 calc(33.333% - 10px);
                }
            }
    
            @media (max-width: 600px) {
                .image-container img {
                    flex: 1 1 calc(50% - 10px);
                }
            }
    
            @media (max-width: 400px) {
                .image-container img {
                    flex: 1 1 100%;
                }
            }
        </style>
    </head>
<body>
    <h1>Project 2</h1>

    <p>Hello, here is things.</p>

    <h2>Section 1.1:</h2>

    <p>Here we first begin by taking the convolutions of the x and y difference filters. These are the magnitude outputs from taking the pointwise absolute value of the convolution output:</p>
    <p> D_x output magnitude:</p>
    <img src="./media/fun_with_filters/Dx_prefilter.jpg" style="transform: scale(0.75);">
    <p>D_y output magnitude:</p>
    <img src="./media/fun_with_filters/Dy_prefilter.jpg" style="transform: scale(0.75);">

    <p>We can now do some thresholding to remove some noise and get a clearer picture of the edges. Here we do this by applying thresholding such that elements below the 98.5th percentile of values are set to zero, and everything above is set to 1. This insures that only the most prominent edges are maintained.</p>
    <p> D_x thresholded output magnitude:</p>
    <img src="./media/fun_with_filters/Dx.jpg" style="transform: scale(0.75);">
    <p>D_y thresholded output magnitude:</p>
    <img src="./media/fun_with_filters/Dy.jpg" style="transform: scale(0.75);">

    <div class="pagebreak"> </div>

    <h2>Section 1.2:</h2>
    <p>
        We see below there are two primary changes in this formulation. First is that we generally have less edges detected.
        Note here that we used the 98th instead of the 98.5th percentile here and despite this, we actually get less noise in the grassy region. This is most noticable if we look at what the Dy output looks like before we threshold in both cases. We see that if we do not apply the gaussian filter, the very bottom on the image is filled with a lot of very fine details that we do not care about.
        The other major change is that on the edges we do preserve, the lines are thicker. This is simply a result of the gaussian filter blurring out the edges,
        making them encompass a wider region. We are still able to capture them desipte having lower frequency by applying this binary filtering, which accounts for relative differences across images.
    </p>

    <p>Here we use a gaussian filter with k=3 and sigma=0 for cv2.getGaussianKernel.</p>

    <p>Dx convolution magnitude output after applying gaussian filter:</p>
    <img src="./media/fun_with_filters/Dx_gaussian_mag.jpg" style="transform: scale(0.75);">
    <p>Dy convolution magnitude output after applying gaussian filter:</p>
    <img src="./media/fun_with_filters/Dy_gaussian_mag.jpg" style="transform: scale(0.75);">
    <p>Dx binary threshold via 98th percentile:</p>
    <img src="./media/fun_with_filters/Dx_gaussian_thresh.jpg" style="transform: scale(0.75);">
    <p>Dy binary threshold via 98th percentile:</p>
    <img src="./media/fun_with_filters/Dy_gaussian_thresh.jpg" style="transform: scale(0.75);">

    <p>Now to combine this in to a single convolution. We can simply convolve the gaussian and the edge filters together, then perform
        the convolution as before:
    </p>

    <p>Output of combined Dx filter:</p>
    <img src="./media/fun_with_filters/x_combined.jpg" style="transform: scale(0.75);">
    <p>Output of combined Dy filter:</p>
    <img src="./media/fun_with_filters/y_combined.jpg" style="transform: scale(0.75);">

    <p>Visually, it is clear that this is the same output, but we can further verify by taking the difference 
        between this image and the old one where we did two setps:
    </p>

    <p>magnitude of two step Dx filter minus one step combined Dx filter:</p>
    <img src="./media/fun_with_filters/diff_x.jpg" style="transform: scale(0.75);">
    <p>magnitude of two step Dy filter minus one step combined Dy filter:</p>
    <img src="./media/fun_with_filters/diff_y.jpg" style="transform: scale(0.75);">

    <p>Note in practice, it is likely that these will not always match perfectly due to floating point and machine errors as we are computing in a different order.
        Regardless, to the human eye, there should generally be no difference.
    </p>
    <div class="pagebreak"> </div>

    <h2>Section 2.1:</h2>
    <p>Here we obetain the unsharp mask filter via the formula: (1 + alpha)*id - alpha * gaussian_filer
         where alpha is a scalar value of our choice, id is the identity filter.
    </p>

    <p>Here is an application of the filter onto taj.jpg.</p>

    

    <p>Image before unsharp filter application:</p>
    <img src="./media/fun_with_frequencies/taj.jpg" style="transform: scale(0.75);">
    <p>alpha=1:</p>
    <img src="./media/fun_with_frequencies/taj_sharp1.jpg" style="transform: scale(0.75);">
    <p>alpha=2:</p>
    <img src="./media/fun_with_frequencies/taj_sharp2.jpg" style="transform: scale(0.75);">
    <p>alpha=3:</p>
    <img src="./media/fun_with_frequencies/taj_sharp3.jpg" style="transform: scale(0.75);">
    <p>alpha=4:</p>
    <img src="./media/fun_with_frequencies/taj_sharp4.jpg" style="transform: scale(0.75);">
    <p>alpha=5 vs original (alpha=5 on left):</p>
    <div class="image-container">
    <img src="./media/fun_with_frequencies/taj_sharp5.jpg" style="transform: scale(0.75);">
    <img src="./media/fun_with_frequencies/taj.jpg" style="transform: scale(0.75);">
    </div>
    <p>Once again we are going to apply the filter. We see how the image in general 
        becomes more jagged and grainy. Take note of the sand and rocks at the bottom, with fine patterns, that are more emphasized when we sharpen.
    </p>

    
    <p>Image before unsharp filter application:</p>
    <img src="./media/fun_with_frequencies/frut.jpg" style="transform: scale(0.5);">
    <p>alpha=1, 2:</p>
    <div class="image-container">
    <img src="./media/fun_with_frequencies/frut_sharp1.jpg" style="transform: scale(0.5);">
    <img src="./media/fun_with_frequencies/frut_sharp2.jpg" style="transform: scale(0.5);">
    </div>
    <p>alpha=3, 4:</p>
   
    <div class="image-container">
    <img src="./media/fun_with_frequencies/frut_sharp3.jpg" style="transform: scale(0.5);">
    <img src="./media/fun_with_frequencies/frut_sharp4.jpg" style="transform: scale(0.5);">
    </div>

    <p>alpha=5 vs original (alpha=5 on left):</p>
    <div class="image-container">
    <img src="./media/fun_with_frequencies/frut_sharp5.jpg" style="transform: scale(0.5);">
    <img src="./media/fun_with_frequencies/frut.jpg" style="transform: scale(0.5);">
    </div>

    <p>Now for fun let us try a needlessly high alpha value to see what happens. If we take some value like alpha=10, we can start to run into issues with some values blowing up in value.
         Here we see the image becomes way to grainy as we remove too many low frequencies:
    </p>

    
    <p>Image before unsharp filter application:</p>
    <img src="./media/fun_with_frequencies/moo_deng.jpeg" style="transform: scale(0.5);">

    <p>alpha=2, 4:</p>
    <div class="image-container">
    <img src="./media/fun_with_frequencies/moo_sharp1\2.jpg" style="transform: scale(0.5);">
    <img src="./media/fun_with_frequencies/moo_sharp4.jpg" style="transform: scale(0.5);">
    </div>
    <p>alpha=6, 8:</p>
   
    <div class="image-container">
    <img src="./media/fun_with_frequencies/moo_sharp6.jpg" style="transform: scale(0.5);">
    <img src="./media/fun_with_frequencies/moo_sharp8.jpg" style="transform: scale(0.5);">
    </div>

    
    <p>alpha=10 vs original (alpha=10 on left):</p>
    <div class="image-container"></div>
    <img src="./media/fun_with_frequencies/moo_sharp10.jpg" style="transform: scale(0.5);">
    <img src="./media/fun_with_frequencies/moo_deng.jpeg" style="transform: scale(0.5);">
    </div>

    <p>Now let us take a sharp image, downsample, then resharp.</p>

    <p>A rather sharp Moo Deng:</p>
    <img src="./media/fun_with_frequencies/moo_2.jpg" style="transform: scale(1.0);">
    <p>A gaussian Moo Deng:</p>
    <img src="./media/fun_with_frequencies/moo_2blur.jpg" style="transform: scale(1.0);">
    <p>A resharpened  Moo Deng using alpha=5. We do not recover the original as blurring will lose information. Regardless,
         we see that we can recover some subtle details such as the soap bubbles on the nose, and the light reflections on the back. This resembles the original image
          more than the blurred one because of this.</p>
    <img src="./media/fun_with_frequencies/moo_2sharp.jpg" style="transform: scale(1.0);">





    <p>Thank you</p>
</body>
</html>